---
/**
 * Pricing Page
 *
 * Dedicated pricing page with comprehensive product details, purchase flow,
 * FAQ, and trust signals. Designed for visitors who want full information
 * before purchasing.
 *
 * Feature Slice 14: Pricing Page
 */
import PageLayout from '@/layouts/PageLayout.astro';
import Section from '@/components/ui/Section.astro';
import Container from '@/components/ui/Container.astro';
import Card from '@/components/ui/Card.astro';
import Button from '@/components/ui/Button.astro';
import FUDsReduction from '@/components/ui/FUDsReduction.astro';

// What's Included items with icons
const includedItems = [
  {
    icon: 'code',
    title: 'Full Source Code Access',
    description: 'Complete Lattice Lab source code via private GitHub repository. No black boxes.',
  },
  {
    icon: 'package',
    title: '36 Vendor Blueprint Bundles',
    description: 'Pre-configured sources for Anthropic, OpenAI, AWS, GCP, Azure, Meta, NVIDIA, and more.',
  },
  {
    icon: 'refresh',
    title: 'Lifetime Updates',
    description: 'All future updates within the major version included. Just git pull to update.',
  },
  {
    icon: 'server',
    title: 'Self-Hosted Deployment',
    description: 'Run on your laptop, private cloud, or air-gapped environment. Your data never leaves.',
  },
  {
    icon: 'users',
    title: 'Unlimited Team Members',
    description: 'No per-seat pricing. Deploy for your entire team with a single purchase.',
  },
  {
    icon: 'file-text',
    title: 'Artifact Generation',
    description: 'Export comparison tables, decision memos, and board-ready artifacts with citations.',
  },
];

// Purchase flow steps
const purchaseSteps = [
  {
    step: 1,
    title: 'Complete Purchase',
    description: 'Click the buy button and complete payment via Stripe. Secure, encrypted checkout.',
  },
  {
    step: 2,
    title: 'Check Your Email',
    description: "You'll receive a confirmation email with setup instructions within minutes.",
  },
  {
    step: 3,
    title: 'Accept GitHub Invite',
    description: 'Within 24 hours, you\'ll receive an invitation to our private repository.',
  },
  {
    step: 4,
    title: 'Clone & Run',
    description: 'Clone the repo, run docker-compose up, and start researching. Setup takes under 5 minutes.',
  },
];

// Pricing-specific FAQs
const pricingFaqs = [
  {
    id: 'pricing-faq-1',
    question: 'Is this a subscription?',
    answer: 'No. This is a one-time purchase of $99. You own Lattice forever with no recurring fees, no usage limits, and no renewal charges. Updates are included via git pull.',
  },
  {
    id: 'pricing-faq-2',
    question: 'What payment methods do you accept?',
    answer: 'We accept all major credit cards, debit cards, and Apple Pay through Stripe. All payments are secure and encrypted.',
  },
  {
    id: 'pricing-faq-3',
    question: 'Can I get a refund?',
    answer: "Absolutely. We offer a 30-day money-back guarantee, no questions asked. If Lattice doesn't meet your needs, email us and we'll refund you in full.",
  },
  {
    id: 'pricing-faq-4',
    question: 'How quickly will I get access?',
    answer: "You'll receive a confirmation email immediately after purchase. GitHub repository access is granted within 24 hours (usually much faster during business hours).",
  },
  {
    id: 'pricing-faq-5',
    question: 'Can I purchase for my team?',
    answer: "Yes! One purchase covers your entire team. There's no per-seat pricing. Share the repository access with as many team members as you need.",
  },
  {
    id: 'pricing-faq-6',
    question: 'Do you offer enterprise pricing?',
    answer: 'Our $99 one-time price works for teams of any size. For enterprise support contracts or custom deployment assistance, contact us at hello@latticelab.io.',
  },
];

// Trust signals / guarantees
const guarantees = [
  {
    icon: 'shield',
    title: '30-Day Money Back',
    description: 'Full refund, no questions asked',
  },
  {
    icon: 'lock',
    title: 'Secure Checkout',
    description: 'Powered by Stripe encryption',
  },
  {
    icon: 'clock',
    title: 'Instant Access',
    description: 'Start in under 5 minutes',
  },
  {
    icon: 'infinity',
    title: 'Lifetime Updates',
    description: 'No subscription required',
  },
];
---

<PageLayout
  title="Pricing - Lattice Lab"
  description="Get lifetime access to Lattice Lab for $99. One-time payment, no subscriptions. Includes all 36 vendor blueprints, full source code, and lifetime updates."
>
  <!-- Hero Section -->
  <Section spacing="lg" background="default" data-testid="pricing-hero">
    <Container size="lg">
      <div class="mx-auto max-w-3xl text-center">
        <span
          class="mb-4 inline-block text-sm font-semibold uppercase tracking-wider text-accent"
          data-testid="pricing-hero-eyebrow"
        >
          Simple, Transparent Pricing
        </span>
        <h1
          class="mb-6 text-4xl font-bold tracking-tight text-foreground sm:text-5xl"
          data-testid="pricing-hero-headline"
        >
          One Price. Lifetime Access.<br />No Subscriptions.
        </h1>
        <p class="text-xl text-muted-foreground" data-testid="pricing-hero-subhead">
          Pay once, own forever. Deploy anywhere. Your AI research assistant for life.
        </p>
      </div>
    </Container>
  </Section>

  <!-- Main Pricing Card -->
  <Section spacing="md" background="muted" data-testid="pricing-main">
    <Container size="lg">
      <div class="mx-auto max-w-lg">
        <Card padding="lg" variant="elevated" class="relative overflow-hidden" data-testid="pricing-main-card">
          <!-- Badge -->
          <div
            class="absolute right-0 top-0 rounded-bl-lg bg-accent px-4 py-1.5 text-sm font-semibold text-accent-foreground"
            data-testid="pricing-main-badge"
          >
            Lifetime Access
          </div>

          <!-- Price -->
          <div class="mb-8 pt-4 text-center" data-testid="pricing-main-price">
            <div class="flex items-baseline justify-center gap-2">
              <span class="text-6xl font-bold text-foreground sm:text-7xl" data-testid="pricing-main-amount">
                $99
              </span>
              <span class="text-xl text-muted-foreground" data-testid="pricing-main-label">
                one-time
              </span>
            </div>
            <p class="mt-3 text-muted-foreground" data-testid="pricing-main-subtitle">
              No subscriptions. No hidden fees. No per-seat pricing.
            </p>
          </div>

          <!-- CTA Button -->
          <div class="mb-6" data-testid="pricing-main-cta-container">
            <!-- Stripe Buy Button Placeholder -->
            <!--
              Stripe Integration (Feature Slice 31):
              <script async src="https://js.stripe.com/v3/buy-button.js"></script>
              <stripe-buy-button
                buy-button-id="buy_btn_1SYXbwRCxnzBPkIXayfIahbD"
                publishable-key="pk_live_..."
              ></stripe-buy-button>
            -->
            <Button
              variant="primary"
              size="lg"
              class="w-full justify-center text-lg py-4"
              data-testid="pricing-main-cta"
            >
              Get Lattice Now
            </Button>
            <p class="mt-3 text-center text-sm text-muted-foreground" data-testid="pricing-main-stripe-note">
              Secure checkout powered by Stripe
            </p>
          </div>

          <!-- FUDs -->
          <div class="flex justify-center border-t border-border pt-6" data-testid="pricing-main-fuds">
            <FUDsReduction />
          </div>
        </Card>
      </div>
    </Container>
  </Section>

  <!-- What's Included Section -->
  <Section spacing="lg" background="default" data-testid="pricing-included">
    <Container size="lg">
      <div class="mx-auto max-w-3xl text-center">
        <h2
          class="mb-4 text-3xl font-bold tracking-tight text-foreground sm:text-4xl"
          data-testid="pricing-included-headline"
        >
          Everything You Get
        </h2>
        <p class="text-lg text-muted-foreground" data-testid="pricing-included-subhead">
          One purchase. Complete access. No limitations.
        </p>
      </div>

      <div class="mx-auto mt-12 grid max-w-5xl gap-8 sm:grid-cols-2 lg:grid-cols-3" data-testid="pricing-included-grid">
        {
          includedItems.map((item, index) => (
            <div
              class="flex gap-4"
              data-testid={`pricing-included-item-${index}`}
            >
              <div class="flex h-12 w-12 flex-shrink-0 items-center justify-center rounded-lg bg-accent/10">
                <svg
                  class="h-6 w-6 text-accent"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                  aria-hidden="true"
                >
                  {item.icon === 'code' && (
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4" />
                  )}
                  {item.icon === 'package' && (
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4" />
                  )}
                  {item.icon === 'refresh' && (
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
                  )}
                  {item.icon === 'server' && (
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 12h14M5 12a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v4a2 2 0 01-2 2M5 12a2 2 0 00-2 2v4a2 2 0 002 2h14a2 2 0 002-2v-4a2 2 0 00-2-2m-2-4h.01M17 16h.01" />
                  )}
                  {item.icon === 'users' && (
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z" />
                  )}
                  {item.icon === 'file-text' && (
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                  )}
                </svg>
              </div>
              <div>
                <h3 class="font-semibold text-foreground" data-testid={`pricing-included-item-${index}-title`}>
                  {item.title}
                </h3>
                <p class="mt-1 text-sm text-muted-foreground" data-testid={`pricing-included-item-${index}-desc`}>
                  {item.description}
                </p>
              </div>
            </div>
          ))
        }
      </div>
    </Container>
  </Section>

  <!-- Purchase Flow Section -->
  <Section spacing="lg" background="muted" data-testid="pricing-flow">
    <Container size="lg">
      <div class="mx-auto max-w-3xl text-center">
        <h2
          class="mb-4 text-3xl font-bold tracking-tight text-foreground sm:text-4xl"
          data-testid="pricing-flow-headline"
        >
          How It Works
        </h2>
        <p class="text-lg text-muted-foreground" data-testid="pricing-flow-subhead">
          From purchase to research in under 5 minutes
        </p>
      </div>

      <div class="mx-auto mt-12 max-w-4xl" data-testid="pricing-flow-steps">
        <div class="grid gap-8 sm:grid-cols-2 lg:grid-cols-4">
          {
            purchaseSteps.map((item, index) => (
              <div class="relative text-center" data-testid={`pricing-flow-step-${index}`}>
                {/* Step number */}
                <div class="mx-auto mb-4 flex h-12 w-12 items-center justify-center rounded-full bg-accent text-xl font-bold text-accent-foreground" data-testid={`pricing-flow-step-${index}-number`}>
                  {item.step}
                </div>
                <h3 class="mb-2 font-semibold text-foreground" data-testid={`pricing-flow-step-${index}-title`}>
                  {item.title}
                </h3>
                <p class="text-sm text-muted-foreground" data-testid={`pricing-flow-step-${index}-desc`}>
                  {item.description}
                </p>
                {/* Connector line (hidden on last item and mobile) */}
                {index < purchaseSteps.length - 1 && (
                  <div class="absolute top-6 left-[calc(50%+2rem)] hidden h-0.5 w-[calc(100%-4rem)] bg-border lg:block" aria-hidden="true" />
                )}
              </div>
            ))
          }
        </div>
      </div>
    </Container>
  </Section>

  <!-- Guarantees Section -->
  <Section spacing="md" background="default" data-testid="pricing-guarantees">
    <Container size="lg">
      <div class="mx-auto max-w-4xl">
        <div class="grid gap-6 sm:grid-cols-2 lg:grid-cols-4" data-testid="pricing-guarantees-grid">
          {
            guarantees.map((item, index) => (
              <div
                class="flex flex-col items-center text-center p-6 rounded-lg bg-surface-2 border border-border"
                data-testid={`pricing-guarantee-${index}`}
              >
                <div class="mb-3 flex h-12 w-12 items-center justify-center rounded-full bg-success/10">
                  <svg
                    class="h-6 w-6 text-success"
                    fill="none"
                    stroke="currentColor"
                    viewBox="0 0 24 24"
                    aria-hidden="true"
                  >
                    {item.icon === 'shield' && (
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" />
                    )}
                    {item.icon === 'lock' && (
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" />
                    )}
                    {item.icon === 'clock' && (
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                    )}
                    {item.icon === 'infinity' && (
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18.178 8c5.096 0 5.096 8 0 8-5.095 0-7.133-8-12.739-8-4.781 0-4.781 8 0 8 5.606 0 7.644-8 12.74-8z" />
                    )}
                  </svg>
                </div>
                <h3 class="font-semibold text-foreground" data-testid={`pricing-guarantee-${index}-title`}>
                  {item.title}
                </h3>
                <p class="mt-1 text-sm text-muted-foreground" data-testid={`pricing-guarantee-${index}-desc`}>
                  {item.description}
                </p>
              </div>
            ))
          }
        </div>
      </div>
    </Container>
  </Section>

  <!-- Pricing FAQ Section -->
  <Section spacing="lg" background="muted" data-testid="pricing-faq">
    <Container size="lg">
      <div class="mx-auto max-w-3xl text-center">
        <h2
          class="mb-4 text-3xl font-bold tracking-tight text-foreground sm:text-4xl"
          data-testid="pricing-faq-headline"
        >
          Pricing Questions
        </h2>
        <p class="text-lg text-muted-foreground" data-testid="pricing-faq-subhead">
          Everything you need to know about purchasing Lattice
        </p>
      </div>

      <div class="mx-auto mt-12 max-w-3xl" data-testid="pricing-faq-list">
        {
          pricingFaqs.map((faq) => (
            <div class="border-b border-border" data-testid={faq.id}>
              <details class="group" data-testid={`${faq.id}-details`}>
                <summary
                  class="flex cursor-pointer items-center justify-between gap-4 py-5 text-left font-medium text-foreground transition-colors hover:text-accent focus:outline-none focus-visible:ring-2 focus-visible:ring-accent focus-visible:ring-offset-2 focus-visible:ring-offset-background"
                  data-testid={`${faq.id}-question`}
                >
                  <span class="text-base sm:text-lg">{faq.question}</span>
                  <svg
                    class="h-5 w-5 flex-shrink-0 text-muted-foreground transition-transform duration-200 group-open:rotate-180"
                    fill="none"
                    stroke="currentColor"
                    viewBox="0 0 24 24"
                    aria-hidden="true"
                  >
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                  </svg>
                </summary>
                <div class="pb-5 pr-12 text-muted-foreground" data-testid={`${faq.id}-answer`}>
                  <p class="text-sm sm:text-base leading-relaxed">{faq.answer}</p>
                </div>
              </details>
            </div>
          ))
        }
      </div>

      <!-- Contact -->
      <div class="mt-10 text-center" data-testid="pricing-faq-contact">
        <p class="text-muted-foreground">
          Still have questions?{' '}
          <a
            href="mailto:hello@latticelab.io"
            class="font-medium text-accent underline underline-offset-4 hover:text-accent/80"
            data-testid="pricing-faq-contact-link"
          >
            Get in touch
          </a>
        </p>
      </div>
    </Container>
  </Section>

  <!-- Final CTA Section -->
  <Section spacing="lg" background="default" data-testid="pricing-final-section">
    <Container size="lg">
      <div class="mx-auto max-w-3xl text-center">
        <h2
          class="mb-4 text-3xl font-bold tracking-tight text-foreground sm:text-4xl"
          data-testid="pricing-final-headline"
        >
          Ready to Transform Your AI Research?
        </h2>
        <p class="mb-8 text-lg text-muted-foreground" data-testid="pricing-final-subhead">
          Join engineers who've cut their AI research time from weeks to hours.
        </p>

        <div class="flex flex-col items-center gap-4 sm:flex-row sm:justify-center" data-testid="pricing-final-buttons">
          <Button
            variant="primary"
            size="lg"
            class="px-8"
            data-testid="pricing-final-cta"
          >
            Get Lattice for $99
          </Button>
          <Button
            variant="secondary"
            size="lg"
            href="/"
            class="px-8"
            data-testid="pricing-final-learn-more"
          >
            Learn More
          </Button>
        </div>

        <div class="mt-6" data-testid="pricing-final-fuds">
          <FUDsReduction />
        </div>
      </div>
    </Container>
  </Section>
</PageLayout>

<style>
  /* FAQ accordion styles */
  details summary::-webkit-details-marker {
    display: none;
  }

  details summary {
    list-style: none;
  }

  details[open] > div {
    animation: slideDown 0.2s ease-out;
  }

  @keyframes slideDown {
    from {
      opacity: 0;
      transform: translateY(-8px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
</style>
