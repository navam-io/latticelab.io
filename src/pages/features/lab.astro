---
import Layout from '@layouts/Layout.astro';
import Header from '@components/Header.vue';
import Footer from '@components/Footer.vue';
import StickyNav from '@components/features/StickyNav.vue';
import FeatureHero from '@components/features/FeatureHero.vue';
import CapabilitySection from '@components/features/CapabilitySection.vue';
import TechSpecs from '@components/features/TechSpecs.vue';
import RelatedContent from '@components/features/RelatedContent.vue';

// Icon paths (Heroicons)
const icons = {
  chat: 'M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z',
  lightbulb: 'M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z',
  shield: 'M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z',
  extraction: 'M7 8h10M7 12h4m1 8l-4-4H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-3l-4 4z',
  lightning: 'M13 10V3L4 14h7v7l9-11h-7z',
  code: 'M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4',
  cog: 'M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z',
  eye: 'M15 12a3 3 0 11-6 0 3 3 0 016 0z M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z'
};

// Navigation items
const navItems = [
  { id: 'overview', label: 'Overview' },
  { id: 'capabilities', label: 'Capabilities' },
  { id: 'specs', label: 'Tech Specs' },
  { id: 'resources', label: 'Resources' }
];

// Capability 1: LangGraph Research Agent features
const agentFeatures = [
  '<strong>Multi-step reasoning</strong> for complex questions',
  'Visible <strong>thinking steps</strong> and reasoning traces',
  '<strong>Source retrieval</strong> before response generation',
  'Powered by <strong>LangGraph</strong> orchestration',
  '<strong>Streaming</strong> responses with real-time updates'
];

// Capability 2: Grounded Recommendations features
const groundedFeatures = [
  'Numbered <strong>inline citations</strong> [1], [2], [3]',
  'Click citations to see <strong>source context</strong>',
  '<strong>Verify claims</strong> against original documents',
  'No hallucinations—just <strong>verifiable claims</strong>'
];

// Capability 3: Conversation Extraction features
const extractionFeatures = [
  'Extract <strong>workload type</strong> and SLO requirements',
  'Identify <strong>budget</strong> and compliance constraints',
  'Create <strong>scenarios</strong> from natural discussion',
  'Turn <strong>chat</strong> into structured requirements'
];

// Capability 4: Smart Prompts features
const promptFeatures = [
  '<strong>Suggested prompts</strong> based on workspace state',
  '<strong>@ mentions</strong> for source references',
  'Multi-line input with <strong>Shift+Enter</strong>',
  '<strong>Context-aware</strong> prompt recommendations'
];

// Tech specs
const techSpecs = [
  {
    category: 'AI Engine',
    icon: icons.lightbulb,
    color: 'blue',
    items: [
      '<strong>LangGraph</strong> - Multi-step orchestration',
      '<strong>GPT-4</strong> - Primary reasoning model',
      '<strong>Streaming</strong> - Real-time responses',
      '<strong>RAG</strong> - Retrieval-augmented generation'
    ]
  },
  {
    category: 'Conversation',
    icon: icons.chat,
    color: 'violet',
    items: [
      '<strong>Chat history</strong> - Persistent sessions',
      '<strong>@ mentions</strong> - Source references',
      '<strong>Extraction</strong> - Scenario creation',
      '<strong>Multi-line</strong> - Rich input support'
    ]
  },
  {
    category: 'Transparency',
    icon: icons.eye,
    color: 'teal',
    items: [
      '<strong>Thinking traces</strong> - Visible reasoning',
      '<strong>Citations</strong> - Inline references',
      '<strong>Source chunks</strong> - Click to verify',
      '<strong>Confidence</strong> - Response scoring'
    ]
  }
];

// Related content
const journeys = [
  {
    title: 'Chatting with AI',
    description: 'Learn how to get grounded recommendations from the Lab',
    href: '/blog/journey-chat-with-ai'
  },
  {
    title: 'Asking About Scenarios',
    description: 'Get AI analysis of your infrastructure scenarios',
    href: '/blog/journey-ask-about-scenarios'
  },
  {
    title: 'Creating Scenarios from Chat',
    description: 'Extract structured requirements from conversations',
    href: '/blog/journey-create-scenario'
  }
];

const docs = [
  {
    title: 'Lab API Reference',
    description: 'Complete API documentation for the Lab panel',
    href: '/docs/api/lab'
  },
  {
    title: 'LangGraph Integration',
    description: 'Technical details on the reasoning engine',
    href: '/docs/features/lab'
  }
];
---

<Layout
  title="Lab - AI Research Agent | Lattice"
  description="LangGraph-powered research agent with transparent reasoning. Get grounded recommendations with citations to your sources."
  keywords="AI research agent, LangGraph, grounded recommendations, citation tracking, AI analysis, transparent reasoning"
>
  <Header client:load />

  <main>
    <!-- Sticky Navigation -->
    <StickyNav
      client:load
      featureName="Lab"
      navItems={navItems}
      buyButtonText="Get Lattice"
      buyButtonHref="/#pricing"
      testId="lab-nav"
    />

    <!-- Hero Section -->
    <section id="overview">
      <FeatureHero
        client:load
        headline="Research Agent. Grounded."
        tagline="Think Verify Trust"
        description="Chat with an AI research agent powered by LangGraph. Get recommendations grounded in your sources with transparent reasoning traces and full citations."
        productImage="/images/journeys/chat-with-ai/chat-with-ai-04.png"
        productImageAlt="Lattice Lab panel showing AI conversation with grounded recommendations and citations"
        browserUrl="lattice.app/lab"
        colorScheme="blue"
        primaryCTA="Get Lattice"
        primaryHref="/#pricing"
        secondaryCTA="View docs"
        secondaryHref="/docs/features/lab"
        testId="lab-hero"
      />
    </section>

    <!-- Capabilities Section -->
    <section id="capabilities">
      <!-- LangGraph Research Agent -->
      <CapabilitySection
        client:load
        title="LangGraph Research Agent"
        description="Powered by LangGraph for multi-step reasoning. The agent searches your sources, synthesizes findings, and provides recommendations—all with transparent thinking traces."
        features={agentFeatures}
        image="/images/journeys/chat-with-ai/chat-with-ai-01.png"
        imageAlt="LangGraph research agent with reasoning traces"
        icon={icons.lightbulb}
        iconColor="blue"
        imagePosition="left"
        background="white"
        showBrowserFrame={true}
        journeyLink="/blog/journey-chat-with-ai"
        journeyLinkText="Learn to chat with AI"
        testId="lab-agent"
      />

      <!-- Grounded Recommendations -->
      <CapabilitySection
        client:load
        title="Grounded Recommendations"
        description="Every recommendation cites specific chunks from your sources. No hallucinations—just verifiable claims with full provenance."
        features={groundedFeatures}
        image="/images/journeys/chat-with-ai/chat-with-ai-03.png"
        imageAlt="Grounded recommendations with citations"
        icon={icons.shield}
        iconColor="teal"
        imagePosition="right"
        background="gray"
        showBrowserFrame={true}
        showGlow={true}
        journeyLink="/blog/journey-chat-with-ai"
        journeyLinkText="See citation tracking"
        testId="lab-grounded"
      />

      <!-- Conversation Extraction -->
      <CapabilitySection
        client:load
        title="Conversation Extraction"
        description="Turn chat discussions into structured scenarios. Lattice extracts requirements, constraints, and preferences from your conversation."
        features={extractionFeatures}
        image="/images/journeys/chat-with-ai/chat-with-ai-02.png"
        imageAlt="Extracting scenarios from conversation"
        icon={icons.extraction}
        iconColor="violet"
        imagePosition="left"
        background="white"
        showBrowserFrame={true}
        journeyLink="/blog/journey-create-scenario"
        journeyLinkText="Create scenarios from chat"
        testId="lab-extraction"
      />

      <!-- Smart Prompts -->
      <CapabilitySection
        client:load
        title="Smart Prompts"
        description="Context-aware prompt suggestions help you get the most from your research. @ mentions let you reference specific sources in your questions."
        features={promptFeatures}
        image="/images/journeys/chat-with-ai/chat-with-ai-05.png"
        imageAlt="Smart prompts and @ mentions"
        icon={icons.lightning}
        iconColor="teal"
        imagePosition="right"
        background="gray"
        showBrowserFrame={true}
        testId="lab-prompts"
      />
    </section>

    <!-- Tech Specs Section -->
    <section id="specs">
      <TechSpecs
        client:load
        title="Technical Specifications"
        description="Everything you need to know about the Lab panel's AI capabilities and conversation features."
        icon={icons.cog}
        iconColor="blue"
        specs={techSpecs}
        columns={3}
        background="white"
        docsLink="/docs/features/lab"
        docsLinkText="View full documentation"
        testId="lab-specs"
      />
    </section>

    <!-- Related Resources Section -->
    <section id="resources">
      <RelatedContent
        client:load
        title="Learn More About Lab"
        description="Explore guides and documentation to get the most out of the AI research agent."
        journeys={journeys}
        docs={docs}
        background="gray"
        ctaLink="/docs/features/lab"
        ctaText="View Lab documentation"
        testId="lab-resources"
      />
    </section>

    <!-- CTA Section -->
    <section class="py-16 bg-gradient-to-r from-blue-600 to-indigo-600">
      <div class="container mx-auto px-4 text-center">
        <h2 class="text-3xl font-bold text-white mb-4">
          Research with Confidence
        </h2>
        <p class="text-xl text-white/80 mb-8 max-w-2xl mx-auto">
          Get AI-powered analysis grounded in your sources with transparent reasoning.
        </p>
        <a
          href="/#pricing"
          class="inline-flex items-center px-8 py-4 bg-white text-blue-600 font-semibold rounded-xl hover:bg-gray-100 transition-colors"
          data-testid="lab-cta-button"
        >
          Get Lattice for $99
        </a>
      </div>
    </section>
  </main>

  <Footer client:load />
</Layout>
